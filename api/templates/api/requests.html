{% extends 'api/base.html' %}

{% block content3 %}


<script type="text/javascript">

var params_obj = {};




function send_request() {
	alert('hi');
	
	var request_url = $('#request_url').val();
	var request_type = $('#request_type').val();

	alert(request_url);
	alert(request_type);

$('.params').each(function(i, obj) {
    //test
    //alert($(obj).attr('class'));
    var key = $(obj).find('.key').val();
    alert(key);
    var value = $(obj).find('.value').val();
    alert(value);


    params_obj[key] = value;
    var params_string = JSON.stringify(params_obj);

    alert(params_string);



});


$.ajax({
	url: "/api_request/",
	type: "POST",
	data : {"request_type":request_type, "request_url":request_url, "params_string":params_string}
	success : function() {
		alert('success');
	}

})



}



$(document).ready(function(){
	$("#param_key").on("keyup", function() {


 

});


		$("#param_value").on(" keyup", function() {

value = $(this).val();
key = $('#param_key').val();

obj[key] = value;
var string = JSON.stringify(obj);

$('#params_string').val(string);

 
});

	});
</script>


<div class="container-fluid panel panel-default" style="padding: 25; ">

<div class="row">

<form action="/api_request/" method="post">
	  {% csrf_token %}

<div class="col-md-2">



<span>
	 <select id="request_type" name="request_type" class="form-control">
						<option value="GET">GET</option>
						<option value="POST">POST</option>
						<option value="PUT">PUT</option>
						<option value="DELET">DELETE</option>
						<option value="HEAD">HEAD</option>
						<option value="OPTIONS">OPTIONS</option>
						
					</select>

</span>

</div> <!-- for col-md-1
-->

<div class="col-md-10">

<input id='params_string' hidden type="text" name="string" >

<div class="input-group">




			
<input type="text" hidden name="uid_project" value="{{project.uid}}">
			   
			   

<input id='request_url' required  class="form-control" name="endpoint" type="url" placeholder="Enter request url">

					<span class="input-group-btn">
						<button onclick="send_request()"   class="btn btn-success">Send</button>
					</span>

</div>






</div> <!-- for col-md-10-->






</form>

</div> <!-- for row -->



<br><br>


<p> Params</p>
<div  class="row params">

<div class="col-md-6">

<input  type="text" class="form-control key" name="key" placeholder="Key">

</div>


<div class="col-md-6">

<input  type="text" class="form-control value" name="value" placeholder="Value">

</div>



</div><!-- for params row -->


<div  class="row params">

<div class="col-md-6">

<input  type="text" class="form-control key" name="key" placeholder="Key">

</div>


<div class="col-md-6">

<input  type="text" class="form-control value" name="value" placeholder="Value">

</div>



</div><!-- for params row -->






<br>




<br>
<hr>
<p style="font-size: 115%; text-align: center;">Response</p>

<div class="container-fluid" style="overflow-x: auto">
{% if response %}

<h4>Status</h4>{{status_code}} 
{{reason}}<br>
<br>
<h4>Time </h4> {{time}} s<br>

<!--

<h4>Cookies</h4>

{% for c in cookies %}
{{c.value}}
{% endfor %}

-->

<br>
<h4>Body</h4>
{{response}}
<script type="text/javascript">
	var str = JSON.stringify({{response}}, undefined, 4);
	alert(str);
</script>


<br>
<h4>Headers</h4>



{% for k, v in headers.items %}

<div class="row">

<div class="col-md-2">
{{k}} : 

</div>

<div class="col-md-2">

{{v}}

</div>
</div>

{% endfor %}



<br>
<!--
<h4>Body </h4>


{{response}}
-->

{% else %}
<div class="container" style="background-color:#f6f6f6; text-align: center; color: grey; height: 100">
<br><br>
<p style="font-size: 125%; opacity: 0.6; text-align: center;"> Send Request to Get Response </p>
</div>
{% endif %}

</div>


</div>
{% endblock %}

