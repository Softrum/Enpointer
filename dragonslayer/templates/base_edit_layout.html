<html>
<head>
    <title>{{title}}</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">



  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>





<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css"></link>
<script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.js"></script>



  <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.8/summernote.css" rel="stylesheet">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.8/summernote.js"></script>
<script type="text/javascript">

$(document).ready(function(){

  setInterval(function(){ $(".alert").slideUp(1000, function() { $('.alert').hide()}); }, 2000);
  

  });
</script>

<script type="text/javascript">
$(document).on('shown.bs.modal','#myModal1', function () {
  var overlay = jQuery('<div id="overlay"> </div>');
$('#main').append(overlay)
})

$(document).on('hidden.bs.modal','#myModal1', function () {

$('#overlay').remove();
})

$("#sortable").sortable({revert: 1000});
</script>

<style>



.testclass {
  height: 80px;
  width : 350px; 
}



#myModal1 {

  z-index: 100000;

}

#overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #000;
    filter:alpha(opacity=50);
    -moz-opacity:0.5;
    -khtml-opacity: 0.5;
    opacity: 0.5;
    z-index: 10000;
}

  .strike {
    text-decoration: line-through;
}


.modal-backdrop {

background-color: rgba(0,0,0,.0001) !important;
}

.scrolly {

overflow: auto !important;
overflow-y: hidden !important;
}


.list-card-details {
      overflow: hidden;
    padding: 6px 6px 2px 8px;
    position: relative;
    z-index: 2000;
}


.list-cards {

    overflow-y: auto;
    overflow-x: hidden;
   
    
    
    margin: 0 4px;
    padding: 0 4px;
    z-index: 100;
    min-height: 0;
    margin-bottom: 0px;

}

.listwrapper {
   
   min-width: 360px;
   width: 100%;

    
    margin: 0 5px;
    margin-top: 5px;
    min-height: 35%;
    box-sizing: border-box;
    display: inline-block;
    vertical-align: top;
    white-space: nowrap;
    margin-bottom: 0px;


}

.x {

  display: inline-block;
  float: none;
 
  vertical-align: top;
   
} /* for board elements */

.listcontent {

     
    border-radius: 3px;
    box-sizing: border-box;
    display: flex;
    -ms-flex-direction: column;
    flex-direction: column;
    max-height: 100%;
    position: relative;
    white-space: normal;
    margin-bottom: 0px;

  
}

.testimonial-group {
  overflow-x: auto;
  white-space: nowrap;
  height:85%;
  
}
.testimonial-group > .row > .col-md-4 {
  display: inline-block;
  float: none;
  vertical-align:top;
  margin:5px;
  
}


.connectedSortable {

	min-height: 20px;
}


.connectedSortable2, .connectedSortable3 {

	min-height: 20px;
}


</style>




<!-- stuff for drag and drop in board 

              over: function (event, ui) {
  $(ui.sender).sortable('instance').scrollParent = $(e.target)
}, -->


<script>

function handler( event ) {

  var target = $( event.target );
  k= target.offset();
  alert(k.left);


  }

</script>

<!-- search function -->

<script type="text/javascript">
  
  $(document).ready(function(){

    $("#search_input").on("keyup", function() {

   var value = $(this).val();
   if (value == "") {

    $("#test").html("");
    $("#test").removeAttr("style");


   }


   if (value != "") {

   

   

   $.ajax({

    url: '/search/' + value,
    success:  function(response){
      var r = response["results"];


      $("#test").html("");



      $("#test").css({"padding":"5px", "background-color": "#f6f6f6", 'margin': "5px" })




      $("#test").append("Search for <b>" + value+ "</b> (" +r.length+ " results): <br><br>");


      



      for (i=0; i< 5; i++ ) {


        $("#test").append("<div>" +r[i].issue_id+" " +r[i].title+ "</div>");
       

      }

      


    }

   }); 

     }


});


  });
</script>


  <script>

         $(function() {
            $({{x|safe}}).sortable({
              connectWith: ".connectedSortable",


               items: ".content",
               scroll: true,
               placeholder: "ui-state-highlight",
               helper: 'clone',
              appendTo: 'body',
               
            


sort: function( event, ui ) {

     



var x = ui.offset.left;




if (x>1000) {




   $("#beta").animate({
        'scrollLeft' : '+=30px'}, 20
    );

$( this ).sortable( "instance" ).refreshPositions();
   








};



if (x<150) {


   $("#beta").animate({
        'scrollLeft' : '-=30px'}, 10
    );
   $( this ).sortable( "instance" ).refreshPositions();




};






 

},
  

/*

        out: function(e, ui){

          if ( ($(ui.item).parent().scrollTop() == 0) || ($(ui.item).parent().scrollHeight - $(ui.item).parent().scrollTop() <= $(ui.item).parent().innerHeight() ))
          {

            $(ui.sender).sortable('instance').scrollParent = $(e.target).closest(".lays");

           
          }
          else {

            $(ui.sender).sortable('instance').scrollParent = $(e.target);


            


          }
          


           
           
        },



         
        

 */

      


     

     out: function(e, ui){

  


     

            $(ui.sender).sortable('instance').scrollParent = $(e.target).closest(".lays");

           
        
          


           
           
        },
          

/*

              
               update: function(event, ui) {
                  var productOrder = $(this).sortable('toArray').toString();
                  
                  
           
                  





 

               },

               */



               start: function( event, ui) {

               },


               stop: function( event, ui) {

               },


    update: function( event, ui) {
      
      var sender_list = $(ui.sender).attr('id');

      if (sender_list == undefined) {
        var id = $(this).attr('id');

        var sortedIDs = $(this).sortable( "toArray" ).toString();
        alert('order list: '+ id + 'with issue order:' +sortedIDs);

      }

      





               },

       

               receive: function(event, ui) {




                  
                   
                   var x = String($(ui.item).attr('id'));
                   var y = String(this.id);


              var sortedIDs = $(this).sortable( "toArray" ).toString();
              alert('order list' +y+ 'with issues: ' + sortedIDs);
              $.ajax({
                type:"POST",
                url: "/save_list_order/"+y+"/"+sortedIDs+"/",
                success: function(response){alert('hi')}
              })





$.ajax({
     type: "POST",
     data : {csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value},
     url: '/check_transition_screen/{{project.uid}}/'+ x + '/' + y + '/',
     success: function(response){

         

         if (response == 'No Screen') {
         	var url = '/transition_issue_status/{{project.uid}}/'+ x + '/' + y + '/';
         	

         	     	$.ajax({url: url, success: function(result){
        
    }});
         	

         }

         else {

         	var url = '/show_transition_screen/{{project.uid}}/'+ x + '/' + y + '/'

         	window.location.replace(url);

         }


     }
});





               },


            }).disableSelection();
         });





      </script>


<style>
.ui-state-highlight {
  height: 80px;
  width : 350px;
   display:inline-block;
   vertical-align: top; 
}


</style>




<!-- for plnanning -->

  <script> 

         $(function() {
            $({{y|safe}}).sortable({
              connectWith: ".connectedSortable2",

               
               items: ".content",
               scroll: true,
               placeholder: "testclass",
               scrollSpeed: 40,
               scrollSensitivity: 10,



        


             /* 
               update: function(event, ui) {
                  var productOrder = $(this).sortable('toArray').toString();
                  
                  
                  
           
                  





 

               }, */

               receive: function(event, ui) {
                  
                   
                   var x = String($(ui.item).attr('id'));
                   var y = String(this.id);






$.ajax({
     type: "POST",
     data : {csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value},
     url: '/transition_issue_plan/{{project.uid}}/'+ x + '/' + y + '/',
     success: function(response){

         

         	var url = '/transition_issue_plan/{{project.uid}}/'+ x + '/' + y + '/';
         	

         	$.ajax({url: url, success: function(result){
        
    }});
         	

   




     }
});





               },


            });
         });





      </script>


<style>


</style>

<script type="text/javascript">

$(document).ready(function(){

  $(document).keyup(function(event) {

    if (event.keyCode == 83 && event.ctrlKey) {
    
        $("#search_input").focus();
    }

    });


    $(document).keyup(function(event) {

    if (event.keyCode == 81 && event.ctrlKey) {
    
        $("#filter_input").focus();
    }

    });


      $(document).keyup(function(event) {

    if (event.keyCode == 70 && event.ctrlKey) {
    
        $("#filter").click();
    }

    });

});
  
</script>


</head>


<body id="main" class="container-fluid"  style=" padding-right: 5px; padding-left: 5px;  background-color: #f1f1f1  " >

 





    <!-- Event Modal -->
<div id="myModal1" class="modal">
    <div class="modal-dialog modal-lg" data-keyboard="false">
        <div id="modal-content" class="modal-content">

                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Event</h4>
                </div>
                <div class="modal-body">
                    <p>Loading...1234</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save changes</button>
                </div>

        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- Event modal -->



<!-- Modal -->
<div id="create_issue_types" class="modal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">

     
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Create Issue</h4>
      </div>




      <div class="modal-body">
        

     

           <div class="form-group">Issue Type :
    

       {% for it in project.issuetypes.all %}

      <!--<a href="/show_create_issue_screen/{{project.uid}}/{{it.uid}}/">{{it.title}}</a>-->
<a onclick="$('.modal').modal('hide');" data-toggle="modal" data-target="#myModal1" href="/show_create_issue_screen/{{project.uid}}/{{it.uid}}/">{{it.title}}</a>
       {% endfor %}
       



        </div>













</form>





              </div>



    
    </div>

  </div>
</div>

<!-- modal content -->


























<!-- Modal -->
<div id="myModal2" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Create Issue</h4>
      </div>



      <div class="modal-body">
        

      <form action="/issue/create/{{project.uid}}/100/" method="post">
      {% csrf_token %}
        <div class="form-group">
          <input   type="text" class="form-control" name="title" placeholder="title">
        </div>

        <div class="form-group">
       <input type="text" class="form-control" name="description" placeholder="description">
        </div>

           <div class="form-group">Issue Type :
       <select name="issue_type"> 

       {% for it in project.issuetypes.all %}

       <option value="{{it.uid}}">{{it.title}}</option>

       {% endfor %}
       


       </select>
        </div>



              <div class="form-group">Epic :
       <select name="epic"> 

        <option value=None>None</option>

       {% for e in epics %}

       <option value={{e.uid}}>{{e.title}}</option>

       {% endfor %}


       </select>
        </div>




              <div class="form-group">Version :
       <select name="version"> 

        <option value=None>None</option>

       {% for v in versions %}

       <option value={{v.uid}}>{{v.title}}</option>

       {% endfor %}


       </select>
        </div>



                   <div class="form-group">Priority :
       <select name="priority"> 

      

       {% for p in project.project_prioritys.all %}

       <option value={{p.uid}}>{{p.title}}</option>

       {% endfor %}


       </select>
        </div>




          <div class="form-group">
          <input  type="text" class="form-control" name="project" readonly value={{project.title}}>
        </div>




<!--two ways 

          <div class="form-group">
          <input {{a}} {{a}}  type="text" class="form-control" name="project" readonly value={{project.title}}>
        </div>

        -->


        <!--

        for f in fields 

        f.name f.type f.optioms if required 


        endfor




        -->
   

     




       <button class="btn btn-bold btn-default" type="submit">create</button>

</form>





              </div>



    
    </div>

  </div>
</div>

<!-- modal content -->

<nav style="margin:0px;margin-bottom: 5px; padding: 0px; background-color: white" class="navbar navbar-default">
 


    <div class="navbar-header">
     <a href="/"><img src="https://i.imgur.com/azmQcUA.png" width="100" style="padding: 0; margin-left: 15; margin-top: 10; "></a>
    </div>



    <div style="margin-left: 30%" class="navbar-header">
      <a class="navbar-brand" href="/">Board Layout Editor</a>
    </div>



     
    <ul class="nav navbar-nav ">



    {% if columns %}
<!--
     <li ><a class="btn btn-default" style="height : 35px; padding: 5px; margin-top: 10px; margin-right: 10px;" align="center" href="/edit_layout/{{project.uid}}">Save As Draft</a></li> -->

        <li ><a class="btn btn-default" style="height : 35px; padding: 5px; margin-top: 10px; margin-right: 10px;  width: 100;" align="center" onclick="save()" ><span >Save </span></a></li> 



    <li ><a onclick="$('.edit_button').hide()" class="btn btn-default" style="height : 35px; padding: 5px; margin-top: 10px; width: 100;" align="center" href="/project/board/{{project.uid}}"><span >Cancel </span></a></a></li> 

    {% endif %}





    </ul>





</nav>

<div  id="test"></div>




<div style="padding-right: 0px; margin-right: 0px; padding-left: 0px;" class="container-fluid">

{% if messages %}
<ul class="messages">
    {% for message in messages %}
  <div class="alert alert-success alert-dismissable">
  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>{{ message }}</div>
    {% endfor %}
</ul>
{% endif %}
{% block content %}{% endblock content %}

</div>





      <script type="">


//when modal opens
$('.modal').on('shown.bs.modal', function () {
  console.log('hiesdsds');
})
</script>

  <script>
    $(document).ready(function() {
        $('#summernote').summernote();

    });
  </script>
  <script type="text/javascript">


</script>

<div  id='block_status_form'>

<select name="status">
 
  <option>dsereq</option>
  <option>dsereq</option>
  <option>dsereq</option>
  
</select>

 <button onclick="go($(this).parent())"> Save </button>

</div>


</body>


</html>